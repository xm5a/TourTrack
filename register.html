<script type="module">
    // 1. Import required functions
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-analytics.js";
    import { 
        getAuth, 
        createUserWithEmailAndPassword 
    } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";

    // 2. Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyBzgUTcdlt3DOQvnNsv4f_05sxJt0DUsYg",
        authDomain: "tour-track-ddb18.firebaseapp.com",
        projectId: "tour-track-ddb18",
        storageBucket: "tour-track-ddb18.firebasestorage.app",
        messagingSenderId: "426865781508",
        appId: "1:426865781508:web:8fb7a409f00c536955be51",
        measurementId: "G-TQZT1H6PPS"
    };

    // 3. Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);
    const auth = getAuth(app);

    // 4. Element Selectors
    const regForm = document.querySelector('form');
    const passwordInput = document.getElementById('passwordInput');
    const eyeIcon = document.getElementById('eyeIcon');
    const toggleBtn = document.querySelector('.toggle-password');
    const emailInput = document.getElementById('EmailField');
    const nameInput = document.getElementById('Uname');

    // 5. Registration Logic
    regForm.addEventListener("submit", (e) => {
        e.preventDefault(); // Stop page refresh

        const email = emailInput.value;
        const pass = passwordInput.value;

        createUserWithEmailAndPassword(auth, email, pass)
            .then((userCredential) => {
                alert("Account created successfully!");
                window.location.href = "homepage.html";
            })
            .catch((error) => {
                console.error("Error code:", error.code);
                alert("Error: " + error.message);
            });
    });

    // 6. Password Toggle (Fixed for Module Scope)
    toggleBtn.addEventListener('click', () => {
        if (passwordInput.type === 'password') {
            passwordInput.type = 'text';
            eyeIcon.style.opacity = '0.5'; 
        } else {
            passwordInput.type = 'password';
            eyeIcon.style.opacity = '1';
        }
    });
</script>
